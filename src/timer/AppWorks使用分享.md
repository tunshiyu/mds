<!--
 * @文件描述:
 * @公司: thundersdata
 * @作者: 于效仟
 * @Date: 2022-05-18 10:28:22
 * @LastEditors: 于效仟
 * @LastEditTime: 2022-05-18 10:28:23
-->

背景

上周六早上打开手机翻朋友圈，看到一位阿里的师兄转发的《淘系自研前端研发工具 AppWorks 正式发布》。点开读了下，了解到 AppWorks 本质是 vscode 插件的集合，所以打开 vscode 搜一下这个插件看看。

嚯好家伙，余杭区五星好插件，那我们趁着刚刚发布继续了解下。

什么是 AppWorks

文章的描述：

AppWorks 是社区受到开发者广泛关注的 VS Code 套件，在 VS Code 插件市场有 2w+ 的下载量，是 VS Code 插件市场受开发者喜爱的百佳套件之一，多次登陆 VS Code 插件市场周/月趋势榜。在淘宝内部，AppWorks 日均创建项目 50+ 次，日均区块被使用 50+ 次，DAU 400+。

官方文档的描述：

AppWorks 是一个前端研发工具集，通过提供桌面客户端、编辑器插件、命令行工具的方式让前端应用程序的开发更快更好更轻松。

简单理解就是，安装了这个插件，我们就能使用它的物料、代码提示等能力让自己开发更轻松。

几个特点

那么具体是怎么更快更好更轻松的呢，我总结了以下几个特点。

● 门槛低： GUI+物料库+开发工具箱
● 简化开发流程：pack 创建调试发布，在编辑器内完成工程操作及线上对接
● 提升代码质量：AppWorks Doctor 代码规范和项目质量评估模型并生成评估报告
● AppWorks Data Platform： 进行开发数据的展示和分析
● 编辑器内的编程数据采集：停留时长、编辑时长、添加删除代码数

对几个特点的实践

下面我会结合具体使用的视角逐步对几个特点进行实践。

提升代码质量

首先跑起来一个正在开发的项目,打开项目仪表盘的质量信息，这里可以对项目的 Lint 规范、代码复杂度、代码重复度进行检查并输出得分。

检测后，项目的得分结果。
啊这，规范检测 10 分？？赶紧看看都是什么问题，可不能让师兄看到哈哈哈。仔细看了下，主要是 tab 缩进和对象内的最后一行是否有逗号的问题，我的编辑器继承了云端的存储所以保留了过去的一些代码格式配置。这里有一个一键修复按钮，可以对简单的代码格式问题进行快速优化。我快速修复了一下，lint 规范的评分直接来到了 50，我又花了点时间手动处理了其他问题，算是来到了绿油油的 80.82 分。
这里有一个代码复杂度的概念。这个评分由圈复杂度和可读性共同确定，下面是对这两个指标的定义。

感觉这个可读性测试的描述很迷惑，与程序编写或理解的难度有关，可是理解程度这个词是个感官词。所以我对同一个文件进行了一个小测试，分别是有未使用的引入，注释掉，删掉的维护度细节对比：

当有未使用的引入时，可读性是 5.396,注释后降低到 4.392,删除后仍然是 4.392。精简即是好代码。

编辑器内的编程数据采集

好了，搞了有小一会了，我来通过它的 TIME MASTER 插件看看今天都干了啥，点击 vscode 左侧的 TIME MASTER 图标。这里有几个有意思的东西。

首先是编辑器使用时间 45 分钟，活跃编程时间 10 分钟。我们平常使用的 focus 等时间效率记录软件只能记录你开始使用编辑器的时间，一上午工作下来由于存在编辑器在放着但是有其他事件打断的情况，并不能明显映射出自己的有效工作时间，以后可以通过这个数值看看自己每天真正的投入 code 的时间，并且可以每周记录一下进行复盘，看看自己的工作效率和工作节奏。看来，用了它后对着 vscode 发呆将正式纳入摸鱼时间。

然后有意思的一个功能是编辑时间最长的文件，我这边编辑时间最长的文件由其他同学封装，所以我提高代码质量的评分的时候花了点时间阅读代码逻辑。

这里可以引发思考。如果落到业务开发的时候，可以通过这个功能查看哪部分的业务开发占了大量时间，你可以去复盘一下这块业务的投入产出比。如果说是花了比较长的时间做了一个可以没有多大业务价值的组件，那么这个业务或者交互后面应该怎么去调整。并且一周结尾的时候你也可以看下哪个文件编辑的时间最长，这个应该就是你本周工作的重点，周报的技术细节可以从这里梳理出来。

简化开发流程

好了，改了这么多，我需要提交下代码并且发到日常。DataWorks 将创建、调试和发布项目的操作通过插件的方式集成到了编辑器中，由于我是直接拿已有的项目测试，所以使用了一下 DEF 发布到日常环境的能力。这里是执行了 def p -d。考虑是不是可以把 git add commit 也集成进去。

门槛低

官方文章中对门槛低归结为：GUI+物料库+开发工具箱。开发工具箱就是快速配置前端开发环境。我主要想体验的是 GUI+物料库在编辑器里的体验。之前使用过蚂蚁团队的 umiUI 进行页面配置，他是放在页面里进行一系列的操作。

我首先尝试添加了区块，他会首先进行装包并更新你的 package.json。

然后将整个区块作为一个组件放到你当前文件的同级的 components 文件夹内。并且在你的箭头位置增加这个组件声明，在文件头部增加这个组件的引入。不过有的区块直接生成后会有 ts 报错，并且 scss 使用的是 style module。有一些东西需要使用者进行处理。

然后我尝试使用了基础组件，基础组件是直接从'@icedesign'或者'@alifd/next'引入的。同样是鼠标箭头位置生成组件声明，顶部生成组件引入。

这种方案使用起来还是挺方便的，所以如果使用者对区块已有的组件有初步的了解并且对脚手架做统一的适配，团队使用这套方式应该是比较方便的，独立开发的话使用这套应该不会习惯。

结合 ice 发展的问题

之前读过一篇文章讲得是 ice 的发展史，里面提到一句话。
从数据和用户的反馈来看，在日常开发中用户对 Iceworks 的依赖非常弱，通常只是用来初始化项目和启动调试，使用频率很低 —— 那么这个工具就成了一个食之无味弃之可惜的东西

那么如今这个套件作为 Iceworks 的究极进化版本，它是否解决平常大家生成脚手架然后自己写代码的习惯。以我这个初次使用者看来，首先，现在所谓的"海量"物料库在套件里看起来展示的只是一部分，想找到自己想用的区块或者组件不太方便，而且当前版本的业务组件和基础组件还没有预览功能，需要用户打开对应的文档页面查看。

其次，一些外部社区的团队，他们更期望能非常简单的插入并分享自己的团队中共用的组件，然后团队在开发中可以使用咱们增加物料的能力。我简单看了下当前版本好像只能通过配置物料源的方式添加自定义物料。

并且最后生成的物料在使用时，可能要有一些对物料业务区分的分类，比如列表页的物料组件，详情页的物料组件，展示页的物料组件类似这种业务分类。并且我在考虑他们是否应该有一个明显的物料 ID，同团队在开发时如果看到这个物料比较适合共用，就可以直接把这个物料 ID 发给同事，同事通过物料 ID 一搜能够快速定位到相应的物料。不过这是在高度使用物料库之后才该考虑的事。

总结

总体来说，将提效工具整合到编辑器中是一个很棒的尝试，并且整体做的东西可以 cover 一名前端同学从入职到项目发布的整个生命周期。这一整套的玩法，希望飞冰团队再接再厉，在后面把这个“余杭区五星好插件”的细节打磨的更好。
